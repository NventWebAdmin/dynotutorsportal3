{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";//import React from \"react\";\nimport axios from\"axios\";import{getImagefromData,getVideofromData,getPDFfromData}from\"../js/getMultiMediafromData\";var createAPIUrl=\"https://1e4loh865h.execute-api.us-east-2.amazonaws.com/DEV\";var albumBucketName=\"imageuploadpr\";var bucketRegion=\"us-east-2\";var IdentityPoolId=\"us-east-2:2f0b38a1-03d4-4622-aa8a-7465bd2fea18\";window.AWS.config.update({region:bucketRegion,credentials:new window.AWS.CognitoIdentityCredentials({IdentityPoolId:IdentityPoolId})});var s3=new window.AWS.S3({apiVersion:\"2006-03-01\",params:{Bucket:albumBucketName}});/*\n// load image\n getImageRecordStorage({\n      folderUrl: \"student\",\n      fileName: \"sri\",\n      fileEvent: \"\",\n      callback: (result) => {\n        console.log(result);\n        if (result.isSuccess == \"true\") {\n          let imageTest = document.getElementById(\"inputfileitemimg\");\n          imageTest.src = result.dataprops.data;\n        } else {\n          this.props.reduxprops.setnotificationCompdata({\n            showNotification: \"true\",\n            notificationMessages: [\n              {\n                name: \"message1\",\n                message: result.message,\n                type: \"error\",\n              },\n            ],\n          });\n        }\n      },\n    });\n\n   \n    // uploadimage\n    let result = await createImageRecordStorages({\n      folderUrl: \"student\",\n      fileName: \"sri\",\n      fileEvent: e,\n      callback: (result) => {\n        console.log(result);\n        if (result.isSuccess == \"true\") {\n          let imageTest = document.getElementById(\"inputfileitemimg\");\n          imageTest.src = result.dataprops.Location;\n        } else {\n          this.props.reduxprops.setnotificationCompdata({\n            showNotification: \"true\",\n            notificationMessages: [\n              {\n                name: \"message1\",\n                message: result.message,\n                type: \"error\",\n              },\n            ],\n          });\n        }\n      },\n    });\n\n*/ // function getHtml(template) {\n//   return template.join(\"\\n\");\n// }\nexport var getRecordsAWS=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dataprops){var result,folderUrl,recArray,prefix;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:result={isSuccess:\"false\",message:\"\",dataprops:{}};folderUrl=dataprops.folderUrl;recArray=[\"test\",\"test2\"];prefix=folderUrl;// prefix = \"gouthama/student/ST-PREK-jovi\";\ns3.listObjects({Delimiter:\"\",Prefix:prefix},function(err,data){if(err){console.log(err);result={isSuccess:\"true\",message:\"error retriving file from storage\",dataprops:{}};dataprops.callback(result);return alert(\"There was an error listing your albums: \"+err.message);}else{console.log(data);console.log(JSON.stringify(data));var fileNames=[];var albums=data.Contents.map(function(content){console.log(content.Key.replace(data.Prefix+\"/\",\"\"));var filname=content.Key.replace(data.Prefix+\"/\",\"\");var timenumber=content.LastModified.getTime();fileNames.push({name:filname,label:filname,lastmodified:content.LastModified,timenumber:timenumber});return fileNames;// var prefix = content.Key;\n// var folderUrl = decodeURIComponent(prefix.replace(\"/\", \"\"));\n// console.log(folderUrl);\n// return getHtml([\n//   \"<li>\",\n//   \"<span onclick=\\\"deleteAlbum('\" + folderUrl + \"')\\\">X</span>\",\n//   \"<span onclick=\\\"viewAlbum('\" + folderUrl + \"')\\\">\",\n//   folderUrl,\n//   \"</span>\",\n//   \"</li>\",\n// ]);\n});console.log(albums);result={isSuccess:\"true\",message:\" retrieved file names from storage\",dataprops:{fileNames:fileNames}};dataprops.callback(result);// var message = albums.length\n//   ? getHtml([\n//       \"<p>Click on an album name to view it.</p>\",\n//       \"<p>Click on the X to delete the album.</p>\",\n//     ])\n//   : \"<p>You do not have any albums. Please Create album.\";\n// var htmlTemplate = [\n//   \"<h2>Albums</h2>\",\n//   message,\n//   \"<ul>\",\n//   getHtml(albums),\n//   \"</ul>\",\n//   \"<button onclick=\\\"createAlbum(prompt('Enter Album Name:'))\\\">\",\n//   \"Create New Album\",\n//   \"</button>\",\n// ];\n// document.getElementById(\"appss\").innerHTML = getHtml(htmlTemplate);\n}});return _context.abrupt(\"return\",recArray);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getRecordsAWS(_x){return _ref.apply(this,arguments);};}();function encode(data){var buf=Buffer.from(data);console.log(buf);var base64=buf.toString(\"base64\");return base64;}export function getRecordAWS(_x2){return _getRecordAWS.apply(this,arguments);}// function b64toBlob(b64Data, contentType, sliceSize) {\n//   contentType = contentType || \"\";\n//   sliceSize = sliceSize || 512;\n//   var byteCharacters = atob(b64Data);\n//   var byteArrays = [];\n//   for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n//     var slice = byteCharacters.slice(offset, offset + sliceSize);\n//     var byteNumbers = new Array(slice.length);\n//     for (var i = 0; i < slice.length; i++) {\n//       byteNumbers[i] = slice.charCodeAt(i);\n//     }\n//     var byteArray = new Uint8Array(byteNumbers);\n//     byteArrays.push(byteArray);\n//   }\n//   var blob = new Blob(byteArrays, { type: contentType });\n//   return blob;\n// }\nfunction _getRecordAWS(){_getRecordAWS=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dataprops){var result,folderUrl,fileName,keyParam,params;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(dataprops);result={isSuccess:\"false\",message:\"\",dataprops:{}};folderUrl=dataprops.folderUrl;fileName=dataprops.fileName;//let pdfpageNumber = dataprops.pdfpageNumber;\nkeyParam=folderUrl+\"/\"+fileName;params={Bucket:albumBucketName,Key:keyParam};s3.getObject(params,function(err,data){if(err)console.log(err,err.stack);// an error occurred\nelse{/////////\n// The Base64 string of a simple PDF file\nvar b64=\"\";b64=encode(data.Body);var datacontentType=data.ContentType;// Decode Base64 to binary and show some information about the PDF file (note that I skipped all checks)\nvar bin=atob(b64);console.log(data);console.log(data.Body);console.log(encode(data.Body));console.log(bin);console.log(\"File Size:\",Math.round(bin.length/1024),\"KB\");// Embed the PDF into the HTML page and show it to the user\n////////////\nif(datacontentType.toLowerCase().includes(\"pdf\")){result={isSuccess:\"true\",message:\"photo retrieved\",dataprops:{imgtag:\"\",pdftag:getPDFfromData(data.Body,dataprops),sourcetype:\"PDF\"}};}else if(datacontentType.toLowerCase().includes(\"jpg\")||datacontentType.toLowerCase().includes(\"jpeg\")||datacontentType.toLowerCase().includes(\"png\")){result={isSuccess:\"true\",message:\"photo retrieved\",dataprops:{imgtag:\"\",imgsrc:getImagefromData(data.Body,dataprops),pdftag:\"\",sourcetype:\"IMG\"}};}else if(datacontentType.toLowerCase().includes(\"webm\")||datacontentType.toLowerCase().includes(\"flv\")||datacontentType.toLowerCase().includes(\"mpg\")||datacontentType.toLowerCase().includes(\"mpeg\")||datacontentType.toLowerCase().includes(\"3gp\")||datacontentType.toLowerCase().includes(\"flv\")||datacontentType.toLowerCase().includes(\"mp4\")){result={isSuccess:\"true\",message:\"photo retrieved\",dataprops:{imgtag:\"\",imgsrc:\"\",vidsrc:getVideofromData(data.Body,dataprops),pdftag:\"\",sourcetype:\"VID\"}};}else{result={isSuccess:\"true\",message:\"photo retrieved\",dataprops:{imgtag:\"\",imgsrc:getImagefromData(data.Body,dataprops),pdftag:\"\",sourcetype:\"IMG\"}};}dataprops.callback(result);}// successful response\n/*\n     data = {\n      AcceptRanges: \"bytes\", \n      ContentLength: 3191, \n      ContentType: \"image/jpeg\", \n      ETag: \"\\\"6805f2cfc46c0f04559748bb039d69ae\\\"\", \n      LastModified: <Date Representation>, \n      Metadata: {\n      }, \n      TagCount: 2, \n      VersionId: \"null\"\n     }\n     */});return _context2.abrupt(\"return\",result);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return _getRecordAWS.apply(this,arguments);}export function createRecordAWS(_x3){return _createRecordAWS.apply(this,arguments);}function _createRecordAWS(){_createRecordAWS=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dataprops){var result,folderUrl,fileName,fileEvent,files,file,fileSuffix,dataUrl,base64,mime,bin,length,buf,arr,f,albumPhotosKey,photoKey,upload,promise;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(dataprops);result={isSuccess:\"false\",message:\"\",dataprops:{}};folderUrl=dataprops.folderUrl;fileName=dataprops.fileName;fileEvent=dataprops.fileEvent;fileSuffix=\"\";if(!(fileEvent!==\"\")){_context3.next=13;break;}files=fileEvent.target.files;if(!(!files||!files.length)){_context3.next=10;break;}return _context3.abrupt(\"return\",alert(\"Please choose a file to upload first.\"));case 10:file=files[0];_context3.next=25;break;case 13://file = dataprops.fileSrc.file;\ndataUrl=document.getElementById(dataprops.filehtmlId).src.split(\",\");base64=dataUrl[1];mime=dataUrl[0].match(/:(.*?);/)[1];bin=atob(base64);length=bin.length;// From http://stackoverflow.com/questions/14967647/ (continues on next line)\n// encode-decode-image-with-base64-breaks-image (2013-04-21)\nbuf=new ArrayBuffer(length);arr=new Uint8Array(buf);bin.split(\"\").forEach(function(e,i){return arr[i]=e.charCodeAt(0);});console.log(mime);if(mime.toLowerCase().includes(\"jpg\")){fileSuffix=\"jpg\";}else if(mime.toLowerCase().includes(\"jpeg\")){fileSuffix=\"jpeg\";}else if(mime.toLowerCase().includes(\"png\")){fileSuffix=\"png\";}else{fileSuffix=\"jpeg\";}f=new File([buf],\"filename\",{type:mime});// note: [buf]\n//    let blobUrl = URL.createObjectURL(f);\nfile=f;// let link = document.createElement(\"a\");\n// link.href = blobUrl;\n// link.download = \"filename\";\n// link.innerHTML = \"Download file.\";\n// document.getElementById(\"url1\").appendChild(link);\ncase 25:console.log(file);albumPhotosKey=folderUrl+\"/\";photoKey=albumPhotosKey+fileName+\".\"+fileSuffix;//  photoKey = \"/a/b/c\";\nupload=new window.AWS.S3.ManagedUpload({params:{Bucket:albumBucketName,Key:photoKey,Body:file,ACL:\"public-read\"}});promise=upload.promise();promise.then(function(data){console.log(data);result={isSuccess:\"true\",message:\"Successfully uploaded photo.\",dataprops:data};dataprops.callback(result);//     viewAlbum(folderUrl);\n},function(err){result={isSuccess:\"false\",message:\"There was an error uploading\"+err.message,dataprops:{}};dataprops.callback(result);// return alert(\"There was an error uploading your photo: \", err.message);\n});return _context3.abrupt(\"return\",result);case 32:case\"end\":return _context3.stop();}}},_callee3);}));return _createRecordAWS.apply(this,arguments);}export function updateRecordAWS(_x4){return _updateRecordAWS.apply(this,arguments);}function _updateRecordAWS(){_updateRecordAWS=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dataprops){var result,endurl,fieldProps,objectData,UpdateExpression,ExpressionAttributeNames,ExpressionAttributeValues,index,lastIndex,i,keyindex,valueindex,axiosresult;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(dataprops);result={isSuccess:\"false\",message:\"\",dataprops:{}};endurl=createAPIUrl+\"/\"+dataprops.objectName+\"/update\";console.log(endurl);fieldProps=dataprops.objectData;objectData=dataprops.objectData;UpdateExpression=\"set \";ExpressionAttributeNames={};ExpressionAttributeValues={};index=0;lastIndex=Object.keys(fieldProps).length-1;for(i in fieldProps){console.log();keyindex=\"#a\"+index;ExpressionAttributeNames[keyindex]=i;valueindex=\":x\"+index;ExpressionAttributeValues[valueindex]=fieldProps[i];if(index<lastIndex){UpdateExpression=UpdateExpression+\"#a\"+index+\" = :x\"+index+\" , \";}else{UpdateExpression=UpdateExpression+\"#a\"+index+\" = :x\"+index+\" \";}index=index+1;}console.log(ExpressionAttributeValues);objectData={Key:dataprops.objectPrimaryKeyValue,UpdateExpression:UpdateExpression,ExpressionAttributeNames:ExpressionAttributeNames,ExpressionAttributeValues:ExpressionAttributeValues};_context4.next=16;return axios.post(endurl,objectData,{headers:{\"Content-Type\":\"application/json\"}}).then(function(response){console.log(response);result={isSuccess:\"true\",message:\"user loggedin\",dataprops:response.data};return result;}).catch(function(error){console.log(error.response);var errormessage=\"\";if(error.response){errormessage=error.response.data.message;}else{errormessage=JSON.stringify(error);}result={isSuccess:\"false\",message:errormessage,dataprops:{}};return result;});case 16:axiosresult=_context4.sent;result=axiosresult;console.log(result);return _context4.abrupt(\"return\",result);case 20:case\"end\":return _context4.stop();}}},_callee4);}));return _updateRecordAWS.apply(this,arguments);}export function deleteRecordAWS(_x5){return _deleteRecordAWS.apply(this,arguments);}function _deleteRecordAWS(){_deleteRecordAWS=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dataprops){var result,endurl,objectData,axiosresult;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log(dataprops);result={isSuccess:\"false\",message:\"\",dataprops:{}};endurl=createAPIUrl+\"/\"+dataprops.objectName+\"/delete\";console.log(endurl);objectData={Key:dataprops.objectPrimaryKeyValue};_context5.next=7;return axios.post(endurl,objectData,{headers:{\"Content-Type\":\"application/json\"}}).then(function(response){console.log(response);result={isSuccess:\"true\",message:\"user loggedin\",dataprops:response.data};return result;}).catch(function(error){console.log(error.response);var errormessage=\"\";if(error.response){errormessage=error.response.data.message;}else{errormessage=JSON.stringify(error);}result={isSuccess:\"false\",message:errormessage,dataprops:{}};return result;});case 7:axiosresult=_context5.sent;result=axiosresult;console.log(result);return _context5.abrupt(\"return\",result);case 11:case\"end\":return _context5.stop();}}},_callee5);}));return _deleteRecordAWS.apply(this,arguments);}","map":{"version":3,"sources":["/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/src/videostorage/aws.js"],"names":["axios","getImagefromData","getVideofromData","getPDFfromData","createAPIUrl","albumBucketName","bucketRegion","IdentityPoolId","window","AWS","config","update","region","credentials","CognitoIdentityCredentials","s3","S3","apiVersion","params","Bucket","getRecordsAWS","dataprops","result","isSuccess","message","folderUrl","recArray","prefix","listObjects","Delimiter","Prefix","err","data","console","log","callback","alert","JSON","stringify","fileNames","albums","Contents","map","content","Key","replace","filname","timenumber","LastModified","getTime","push","name","label","lastmodified","encode","buf","Buffer","from","base64","toString","getRecordAWS","fileName","keyParam","getObject","stack","b64","Body","datacontentType","ContentType","bin","atob","Math","round","length","toLowerCase","includes","imgtag","pdftag","sourcetype","imgsrc","vidsrc","createRecordAWS","fileEvent","fileSuffix","files","target","file","dataUrl","document","getElementById","filehtmlId","src","split","mime","match","ArrayBuffer","arr","Uint8Array","forEach","e","i","charCodeAt","f","File","type","albumPhotosKey","photoKey","upload","ManagedUpload","ACL","promise","then","updateRecordAWS","endurl","objectName","fieldProps","objectData","UpdateExpression","ExpressionAttributeNames","ExpressionAttributeValues","index","lastIndex","Object","keys","keyindex","valueindex","objectPrimaryKeyValue","post","headers","response","catch","error","errormessage","axiosresult","deleteRecordAWS"],"mappings":"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","sourcesContent":["//import React from \"react\";\nimport axios from \"axios\";\nimport {\n  getImagefromData,\n  getVideofromData,\n  getPDFfromData,\n} from \"../js/getMultiMediafromData\";\n\nlet createAPIUrl = \"https://1e4loh865h.execute-api.us-east-2.amazonaws.com/DEV\";\n\nvar albumBucketName = \"imageuploadpr\";\nvar bucketRegion = \"us-east-2\";\nvar IdentityPoolId = \"us-east-2:2f0b38a1-03d4-4622-aa8a-7465bd2fea18\";\n\nwindow.AWS.config.update({\n  region: bucketRegion,\n  credentials: new window.AWS.CognitoIdentityCredentials({\n    IdentityPoolId: IdentityPoolId,\n  }),\n});\n\nvar s3 = new window.AWS.S3({\n  apiVersion: \"2006-03-01\",\n  params: { Bucket: albumBucketName },\n});\n\n/*\n// load image\n getImageRecordStorage({\n      folderUrl: \"student\",\n      fileName: \"sri\",\n      fileEvent: \"\",\n      callback: (result) => {\n        console.log(result);\n        if (result.isSuccess == \"true\") {\n          let imageTest = document.getElementById(\"inputfileitemimg\");\n          imageTest.src = result.dataprops.data;\n        } else {\n          this.props.reduxprops.setnotificationCompdata({\n            showNotification: \"true\",\n            notificationMessages: [\n              {\n                name: \"message1\",\n                message: result.message,\n                type: \"error\",\n              },\n            ],\n          });\n        }\n      },\n    });\n\n   \n    // uploadimage\n    let result = await createImageRecordStorages({\n      folderUrl: \"student\",\n      fileName: \"sri\",\n      fileEvent: e,\n      callback: (result) => {\n        console.log(result);\n        if (result.isSuccess == \"true\") {\n          let imageTest = document.getElementById(\"inputfileitemimg\");\n          imageTest.src = result.dataprops.Location;\n        } else {\n          this.props.reduxprops.setnotificationCompdata({\n            showNotification: \"true\",\n            notificationMessages: [\n              {\n                name: \"message1\",\n                message: result.message,\n                type: \"error\",\n              },\n            ],\n          });\n        }\n      },\n    });\n\n*/\n\n// function getHtml(template) {\n//   return template.join(\"\\n\");\n// }\n\nexport let getRecordsAWS = async (dataprops) => {\n  let result = { isSuccess: \"false\", message: \"\", dataprops: {} };\n  let folderUrl = dataprops.folderUrl;\n  let recArray = [\"test\", \"test2\"];\n  let prefix = folderUrl;\n  // prefix = \"gouthama/student/ST-PREK-jovi\";\n  s3.listObjects({ Delimiter: \"\", Prefix: prefix }, function (err, data) {\n    if (err) {\n      console.log(err);\n      result = {\n        isSuccess: \"true\",\n        message: \"error retriving file from storage\",\n        dataprops: {},\n      };\n      dataprops.callback(result);\n      return alert(\"There was an error listing your albums: \" + err.message);\n    } else {\n      console.log(data);\n      console.log(JSON.stringify(data));\n      let fileNames = [];\n      var albums = data.Contents.map(function (content) {\n        console.log(content.Key.replace(data.Prefix + \"/\", \"\"));\n        let filname = content.Key.replace(data.Prefix + \"/\", \"\");\n        let timenumber = content.LastModified.getTime();\n        fileNames.push({\n          name: filname,\n          label: filname,\n          lastmodified: content.LastModified,\n          timenumber: timenumber,\n        });\n        return fileNames;\n        // var prefix = content.Key;\n        // var folderUrl = decodeURIComponent(prefix.replace(\"/\", \"\"));\n        // console.log(folderUrl);\n        // return getHtml([\n        //   \"<li>\",\n        //   \"<span onclick=\\\"deleteAlbum('\" + folderUrl + \"')\\\">X</span>\",\n        //   \"<span onclick=\\\"viewAlbum('\" + folderUrl + \"')\\\">\",\n        //   folderUrl,\n        //   \"</span>\",\n        //   \"</li>\",\n        // ]);\n      });\n      console.log(albums);\n      result = {\n        isSuccess: \"true\",\n        message: \" retrieved file names from storage\",\n        dataprops: {\n          fileNames: fileNames,\n        },\n      };\n      dataprops.callback(result);\n      // var message = albums.length\n      //   ? getHtml([\n      //       \"<p>Click on an album name to view it.</p>\",\n      //       \"<p>Click on the X to delete the album.</p>\",\n      //     ])\n      //   : \"<p>You do not have any albums. Please Create album.\";\n      // var htmlTemplate = [\n      //   \"<h2>Albums</h2>\",\n      //   message,\n      //   \"<ul>\",\n      //   getHtml(albums),\n      //   \"</ul>\",\n      //   \"<button onclick=\\\"createAlbum(prompt('Enter Album Name:'))\\\">\",\n      //   \"Create New Album\",\n      //   \"</button>\",\n      // ];\n      // document.getElementById(\"appss\").innerHTML = getHtml(htmlTemplate);\n    }\n  });\n\n  return recArray;\n};\n\nfunction encode(data) {\n  let buf = Buffer.from(data);\n  console.log(buf);\n  let base64 = buf.toString(\"base64\");\n  return base64;\n}\n\nexport async function getRecordAWS(dataprops) {\n  console.log(dataprops);\n\n  let result = { isSuccess: \"false\", message: \"\", dataprops: {} };\n  let folderUrl = dataprops.folderUrl;\n  let fileName = dataprops.fileName;\n  //let pdfpageNumber = dataprops.pdfpageNumber;\n  let keyParam = folderUrl + \"/\" + fileName;\n  var params = {\n    Bucket: albumBucketName,\n    Key: keyParam,\n  };\n  s3.getObject(params, function (err, data) {\n    if (err) console.log(err, err.stack);\n    // an error occurred\n    else {\n      /////////\n      // The Base64 string of a simple PDF file\n      var b64 = \"\";\n\n      b64 = encode(data.Body);\n      let datacontentType = data.ContentType;\n      // Decode Base64 to binary and show some information about the PDF file (note that I skipped all checks)\n      var bin = atob(b64);\n      console.log(data);\n      console.log(data.Body);\n      console.log(encode(data.Body));\n\n      console.log(bin);\n      console.log(\"File Size:\", Math.round(bin.length / 1024), \"KB\");\n\n      // Embed the PDF into the HTML page and show it to the user\n      ////////////\n      if (datacontentType.toLowerCase().includes(\"pdf\")) {\n        result = {\n          isSuccess: \"true\",\n          message: \"photo retrieved\",\n          dataprops: {\n            imgtag: \"\",\n            pdftag: getPDFfromData(data.Body, dataprops),\n            sourcetype: \"PDF\",\n          },\n        };\n      } else if (\n        datacontentType.toLowerCase().includes(\"jpg\") ||\n        datacontentType.toLowerCase().includes(\"jpeg\") ||\n        datacontentType.toLowerCase().includes(\"png\")\n      ) {\n        result = {\n          isSuccess: \"true\",\n          message: \"photo retrieved\",\n          dataprops: {\n            imgtag: \"\",\n            imgsrc: getImagefromData(data.Body, dataprops),\n            pdftag: \"\",\n            sourcetype: \"IMG\",\n          },\n        };\n      } else if (\n        datacontentType.toLowerCase().includes(\"webm\") ||\n        datacontentType.toLowerCase().includes(\"flv\") ||\n        datacontentType.toLowerCase().includes(\"mpg\") ||\n        datacontentType.toLowerCase().includes(\"mpeg\") ||\n        datacontentType.toLowerCase().includes(\"3gp\") ||\n        datacontentType.toLowerCase().includes(\"flv\") ||\n        datacontentType.toLowerCase().includes(\"mp4\")\n      ) {\n        result = {\n          isSuccess: \"true\",\n          message: \"photo retrieved\",\n          dataprops: {\n            imgtag: \"\",\n            imgsrc: \"\",\n            vidsrc: getVideofromData(data.Body, dataprops),\n            pdftag: \"\",\n            sourcetype: \"VID\",\n          },\n        };\n      } else {\n        result = {\n          isSuccess: \"true\",\n          message: \"photo retrieved\",\n          dataprops: {\n            imgtag: \"\",\n            imgsrc: getImagefromData(data.Body, dataprops),\n            pdftag: \"\",\n            sourcetype: \"IMG\",\n          },\n        };\n      }\n\n      dataprops.callback(result);\n    } // successful response\n    /*\n     data = {\n      AcceptRanges: \"bytes\", \n      ContentLength: 3191, \n      ContentType: \"image/jpeg\", \n      ETag: \"\\\"6805f2cfc46c0f04559748bb039d69ae\\\"\", \n      LastModified: <Date Representation>, \n      Metadata: {\n      }, \n      TagCount: 2, \n      VersionId: \"null\"\n     }\n     */\n  });\n  return result;\n}\n\n// function b64toBlob(b64Data, contentType, sliceSize) {\n//   contentType = contentType || \"\";\n//   sliceSize = sliceSize || 512;\n\n//   var byteCharacters = atob(b64Data);\n//   var byteArrays = [];\n\n//   for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {\n//     var slice = byteCharacters.slice(offset, offset + sliceSize);\n\n//     var byteNumbers = new Array(slice.length);\n//     for (var i = 0; i < slice.length; i++) {\n//       byteNumbers[i] = slice.charCodeAt(i);\n//     }\n\n//     var byteArray = new Uint8Array(byteNumbers);\n\n//     byteArrays.push(byteArray);\n//   }\n\n//   var blob = new Blob(byteArrays, { type: contentType });\n//   return blob;\n// }\n\nexport async function createRecordAWS(dataprops) {\n  console.log(dataprops);\n  let result = { isSuccess: \"false\", message: \"\", dataprops: {} };\n  let folderUrl = dataprops.folderUrl;\n  let fileName = dataprops.fileName;\n  let fileEvent = dataprops.fileEvent;\n  var files, file, fileSuffix;\n  fileSuffix = \"\";\n  if (fileEvent !== \"\") {\n    files = fileEvent.target.files;\n    if (!files || !files.length) {\n      return alert(\"Please choose a file to upload first.\");\n    }\n    file = files[0];\n  } else {\n    //file = dataprops.fileSrc.file;\n\n    let dataUrl = document.getElementById(dataprops.filehtmlId).src.split(\",\");\n    let base64 = dataUrl[1];\n    let mime = dataUrl[0].match(/:(.*?);/)[1];\n    let bin = atob(base64);\n    let length = bin.length;\n    // From http://stackoverflow.com/questions/14967647/ (continues on next line)\n    // encode-decode-image-with-base64-breaks-image (2013-04-21)\n    let buf = new ArrayBuffer(length);\n    let arr = new Uint8Array(buf);\n    bin.split(\"\").forEach((e, i) => (arr[i] = e.charCodeAt(0)));\n    console.log(mime);\n    if (mime.toLowerCase().includes(\"jpg\")) {\n      fileSuffix = \"jpg\";\n    } else if (mime.toLowerCase().includes(\"jpeg\")) {\n      fileSuffix = \"jpeg\";\n    } else if (mime.toLowerCase().includes(\"png\")) {\n      fileSuffix = \"png\";\n    } else {\n      fileSuffix = \"jpeg\";\n    }\n    let f = new File([buf], \"filename\", { type: mime }); // note: [buf]\n    //    let blobUrl = URL.createObjectURL(f);\n    file = f;\n    // let link = document.createElement(\"a\");\n    // link.href = blobUrl;\n    // link.download = \"filename\";\n    // link.innerHTML = \"Download file.\";\n    // document.getElementById(\"url1\").appendChild(link);\n  }\n  console.log(file);\n\n  var albumPhotosKey = folderUrl + \"/\";\n  var photoKey = albumPhotosKey + fileName + \".\" + fileSuffix;\n  //  photoKey = \"/a/b/c\";\n  var upload = new window.AWS.S3.ManagedUpload({\n    params: {\n      Bucket: albumBucketName,\n      Key: photoKey,\n      Body: file,\n      ACL: \"public-read\",\n    },\n  });\n  var promise = upload.promise();\n  promise.then(\n    function (data) {\n      console.log(data);\n      result = {\n        isSuccess: \"true\",\n        message: \"Successfully uploaded photo.\",\n        dataprops: data,\n      };\n      dataprops.callback(result);\n      //     viewAlbum(folderUrl);\n    },\n    function (err) {\n      result = {\n        isSuccess: \"false\",\n        message: \"There was an error uploading\" + err.message,\n        dataprops: {},\n      };\n      dataprops.callback(result);\n      // return alert(\"There was an error uploading your photo: \", err.message);\n    }\n  );\n\n  return result;\n}\n\nexport async function updateRecordAWS(dataprops) {\n  console.log(dataprops);\n\n  let result = { isSuccess: \"false\", message: \"\", dataprops: {} };\n  let endurl = createAPIUrl + \"/\" + dataprops.objectName + \"/update\";\n  console.log(endurl);\n\n  let fieldProps = dataprops.objectData;\n\n  let objectData = dataprops.objectData;\n  let UpdateExpression = \"set \";\n  let ExpressionAttributeNames = {};\n  let ExpressionAttributeValues = {};\n  let index = 0;\n  let lastIndex = Object.keys(fieldProps).length - 1;\n  for (let i in fieldProps) {\n    console.log();\n    let keyindex = \"#a\" + index;\n    ExpressionAttributeNames[keyindex] = i;\n    let valueindex = \":x\" + index;\n    ExpressionAttributeValues[valueindex] = fieldProps[i];\n    if (index < lastIndex) {\n      UpdateExpression =\n        UpdateExpression + \"#a\" + index + \" = :x\" + index + \" , \";\n    } else {\n      UpdateExpression =\n        UpdateExpression + \"#a\" + index + \" = :x\" + index + \" \";\n    }\n    index = index + 1;\n  }\n\n  console.log(ExpressionAttributeValues);\n  objectData = {\n    Key: dataprops.objectPrimaryKeyValue,\n    UpdateExpression: UpdateExpression,\n    ExpressionAttributeNames: ExpressionAttributeNames,\n    ExpressionAttributeValues: ExpressionAttributeValues,\n  };\n  let axiosresult = await axios\n    .post(endurl, objectData, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    })\n    .then((response) => {\n      console.log(response);\n      result = {\n        isSuccess: \"true\",\n        message: \"user loggedin\",\n        dataprops: response.data,\n      };\n      return result;\n    })\n    .catch((error) => {\n      console.log(error.response);\n      let errormessage = \"\";\n      if (error.response) {\n        errormessage = error.response.data.message;\n      } else {\n        errormessage = JSON.stringify(error);\n      }\n      result = {\n        isSuccess: \"false\",\n        message: errormessage,\n        dataprops: {},\n      };\n      return result;\n    });\n  result = axiosresult;\n  console.log(result);\n\n  return result;\n}\n\nexport async function deleteRecordAWS(dataprops) {\n  console.log(dataprops);\n\n  let result = { isSuccess: \"false\", message: \"\", dataprops: {} };\n  let endurl = createAPIUrl + \"/\" + dataprops.objectName + \"/delete\";\n  console.log(endurl);\n\n  let objectData = {\n    Key: dataprops.objectPrimaryKeyValue,\n  };\n  let axiosresult = await axios\n    .post(endurl, objectData, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    })\n    .then((response) => {\n      console.log(response);\n      result = {\n        isSuccess: \"true\",\n        message: \"user loggedin\",\n        dataprops: response.data,\n      };\n      return result;\n    })\n    .catch((error) => {\n      console.log(error.response);\n      let errormessage = \"\";\n      if (error.response) {\n        errormessage = error.response.data.message;\n      } else {\n        errormessage = JSON.stringify(error);\n      }\n      result = {\n        isSuccess: \"false\",\n        message: errormessage,\n        dataprops: {},\n      };\n      return result;\n    });\n  result = axiosresult;\n  console.log(result);\n\n  return result;\n}\n"]},"metadata":{},"sourceType":"module"}