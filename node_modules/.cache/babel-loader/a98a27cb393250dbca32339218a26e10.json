{"ast":null,"code":"var _jsxFileName = \"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/src/components/notepadlist.js\";\nimport React, { Component } from \"react\";\nimport Notepad from \"./notepad\";\nimport { getRecorddata, createRecord, bulkcreateRecord, deleteRecord } from \"../db/index\";\nimport { sortArray, fieldTypeHtmltoDBmapping, getLocalData, serverButtonHandler, filterArraybyObject } from \"../js/index\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass F extends Component {\n  constructor(_props) {\n    super(_props);\n\n    this.getServerData = async props => {\n      let {\n        defaultdatafilter,\n        showallrecordsubscribe,\n        parentobjectfilter,\n        showallrecords\n      } = this.props.compprops;\n      let {\n        tablename,\n        defaultsortparam,\n        enablelocaldbdata,\n        parentid,\n        //  defaultdatafilter,\n        activeNoteId,\n        action //  showallrecordsubscribe,\n        //  parentobjectfilter,\n        //  showallrecords,\n\n      } = props;\n      console.log(props);\n      let localdata = getLocalData(this.props);\n      let dataParamsresult = {};\n      let rsdataParamsresult = {};\n      let dataParamsBeginswith = \"\";\n      let recordData = [];\n      let recordDataFinal = [];\n      let rsData = [];\n      let rsDataFinal = [];\n\n      if (showallrecordsubscribe === \"true\" || Object.keys(parentobjectfilter).length > 0 || showallrecords === \"true\") {\n        dataParamsBeginswith = defaultsortparam + \"-\";\n      } else {\n        dataParamsBeginswith = defaultsortparam + \"-\" + parentid;\n      }\n\n      dataParamsresult = await getRecorddata({\n        objectName: tablename,\n        objectData: {},\n        keyConditions: [{\n          field: \"orgname\",\n          value: localdata.orgname,\n          expression: \"=\"\n        }, {\n          field: \"id\",\n          value: dataParamsBeginswith,\n          expression: \"beginswith\"\n        }],\n        filterConditions: []\n      });\n\n      if (dataParamsresult.isSuccess === \"false\") {\n        alert(\"url not found\");\n      } else {\n        recordData = dataParamsresult.dataprops.Items;\n      }\n\n      console.log(recordData);\n\n      if (showallrecordsubscribe === \"true\" || Object.keys(parentobjectfilter).length > 0) {\n        rsdataParamsresult = await getRecorddata({\n          objectName: parentobjectfilter.objectname,\n          objectData: {},\n          keyConditions: [{\n            field: \"orgname\",\n            value: localdata.orgname,\n            expression: \"=\"\n          }, {\n            field: \"id\",\n            value: parentobjectfilter.beginswith + localdata.userid,\n            expression: \"beginswith\"\n          }],\n          filterConditions: [],\n          pageSize: \"\",\n          limit: \"\",\n          exclusiveStartKey: \"\"\n        });\n\n        if (rsdataParamsresult.isSuccess === \"false\") {\n          alert(\"url not found\");\n        } else {\n          rsData = rsdataParamsresult.dataprops.Items;\n          console.log(rsData);\n          let subscribetoIds = [];\n\n          for (let i = 0; i < rsData.length; i++) {\n            let rsDatavar = rsData[i];\n            subscribetoIds.push(rsDatavar[parentobjectfilter.fieldname]);\n          }\n\n          console.log(subscribetoIds);\n\n          for (let j = 0; j < recordData.length; j++) {\n            let recordDataVar = recordData[j];\n\n            if (subscribetoIds.indexOf(recordDataVar[parentobjectfilter.childfieldname]) !== -1 || recordDataVar[parentobjectfilter.childfieldname] === localdata.userid) {\n              recordDataFinal.push(recordData[j]);\n            }\n          }\n        }\n      } else {\n        recordDataFinal = recordData;\n      }\n\n      console.log(recordDataFinal);\n      recordDataFinal = filterArraybyObject({\n        data: recordDataFinal,\n        filter: defaultdatafilter\n      });\n\n      if (recordDataFinal.length > 0) {\n        if (activeNoteId == \"\" && recordDataFinal.length > 0) {\n          activeNoteId = recordDataFinal[0].id;\n        }\n\n        if (action == \"\") {\n          action = recordDataFinal[0] ? \"view\" : \"create\";\n        }\n\n        this.setState({\n          showUI: false\n        }, () => {\n          this.setState({\n            showUI: true,\n            notes: recordDataFinal,\n            activeNoteId: activeNoteId,\n            // createNote: filtereddata[0] ? false : true,\n            action: action\n          });\n        });\n      } else {\n        this.setState({\n          showUI: false\n        }, () => {\n          this.setState({\n            showUI: true,\n            notes: [],\n            activeNoteId: \"\",\n            action: \"create\" //createNote: true,\n\n          });\n        });\n      }\n    };\n\n    this.noteHeadingClk = noteid => {\n      this.setState({\n        showUI: false\n      }, () => {\n        this.setState({\n          showUI: true,\n          activeNoteId: noteid,\n          //  createNote: false,\n          action: \"view\"\n        });\n      });\n    };\n\n    this.addNote = () => {\n      let {\n        notes\n      } = this.state;\n      notes.push({});\n      this.setState({\n        showUI: false\n      }, () => {\n        this.setState({\n          showUI: true,\n          activeNoteId: \"\",\n          action: \"create\"\n        });\n      });\n    };\n\n    this.refreshNote = async props => {\n      let {\n        noteid\n      } = props;\n      let {\n        tablename,\n        defaultsortparam,\n        enablelocaldbdata,\n        parentid,\n        showallrecordsubscribe,\n        parentobjectfilter,\n        showallrecords\n      } = this.props.compprops;\n      let serverprops = {\n        tablename: tablename,\n        defaultsortparam: defaultsortparam,\n        enablelocaldbdata: enablelocaldbdata,\n        parentid: parentid,\n        //  defaultdatafilter: defaultdatafilter,\n        activeNoteId: noteid,\n        action: \"view\"\n      };\n      await this.getServerData(serverprops); // this.setState({ showUI: false }, () => {\n      //   this.setState({\n      //     showUI: true,\n      //     activeNoteId: noteid,\n      //     createNote: false,\n      //   });\n      // });\n    };\n\n    this.childnoteHandler = async props => {\n      let {\n        recordid,\n        action\n      } = props;\n      let {\n        tablename,\n        defaultsortparam,\n        enablelocaldbdata,\n        parentid\n      } = this.props.compprops;\n      let serverprops = {\n        tablename: tablename,\n        defaultsortparam: defaultsortparam,\n        enablelocaldbdata: enablelocaldbdata,\n        parentid: parentid,\n        //  defaultdatafilter: defaultdatafilter,\n        activeNoteId: recordid,\n        action: action\n      };\n      await this.getServerData(serverprops); // this.setState({ showUI: false }, () => {\n      //   this.setState({\n      //     showUI: true,\n      //     activeNoteId: noteid,\n      //     createNote: false,\n      //   });\n      // });\n    };\n\n    this.state = {\n      notes: [],\n      activeNoteId: \"\",\n      showUI: false,\n      createNote: false,\n      action: \"\"\n    };\n  }\n\n  async componentDidMount() {\n    let {\n      tablename,\n      comphtmlid,\n      showallrecordsubscribe,\n      parentobjectfilter,\n      showallrecords,\n      enablelocaldbdata,\n      listdisplaytype,\n      defaultdatafilter,\n      defaultsortparam,\n      parentid,\n      iscreateactive,\n      isviewactive,\n      iseditactive,\n      isdeleteactive\n    } = this.props.compprops;\n    let props = {\n      tablename: tablename,\n      defaultsortparam: defaultsortparam,\n      enablelocaldbdata: enablelocaldbdata,\n      parentid: parentid,\n      //  defaultdatafilter: defaultdatafilter,\n      activeNoteId: \"\",\n      action: \"\"\n    };\n    await this.getServerData(props);\n  }\n\n  render() {\n    let {\n      iscreateactive,\n      isviewactive,\n      iseditactive,\n      isdeleteactive\n    } = this.props.compprops;\n    let {\n      notes,\n      activeNoteId,\n      showUI,\n      action\n    } = this.state;\n    console.log(this.props.compprops);\n    let mainpanelHtml = [];\n    let notepageHtml = [];\n    let notesHtml = [];\n\n    for (let i = 0; i < notes.length; i++) {\n      if (notes[i].id === activeNoteId) {\n        notesHtml.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: () => {\n            this.noteHeadingClk(notes[i].id);\n          },\n          className: \"org-greybg\",\n          children: notes[i].label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this));\n      } else {\n        notesHtml.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: () => {\n            this.noteHeadingClk(notes[i].id);\n          },\n          children: notes[i].label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 11\n        }, this));\n      }\n    } // if (notes.length > 0 && activeNoteId === \"\") {\n    //   activeNoteId = notes[0].id;\n    // }\n\n\n    notepageHtml.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"org-fr\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"org-flexbasis-100p org-mflexbasis-10p org-lflexbasis-10p\",\n        children: [notesHtml, action === \"list\" || action === \"view\" ? iscreateactive === \"true\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: this.addNote,\n          children: \"+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"org-flexbasis-100p org-mflexbasis-90p org-lflexbasis-90p\",\n        children: showUI === false ? \"\" : /*#__PURE__*/_jsxDEV(Notepad, { ...this.props,\n          noteid: activeNoteId,\n          iseditactive: iseditactive,\n          isdeleteactive: isdeleteactive // createNote={createNote}\n          ,\n          action: action //   refreshNote={this.refreshNote}\n          ,\n          childnoteHandler: this.childnoteHandler //   defaultdatafilter={defaultdatafilter}\n\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this));\n    mainpanelHtml.push(notepageHtml);\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: mainpanelHtml\n    }, void 0, false);\n  }\n\n}\n\nexport default F;","map":{"version":3,"sources":["/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/src/components/notepadlist.js"],"names":["React","Component","Notepad","getRecorddata","createRecord","bulkcreateRecord","deleteRecord","sortArray","fieldTypeHtmltoDBmapping","getLocalData","serverButtonHandler","filterArraybyObject","F","constructor","props","getServerData","defaultdatafilter","showallrecordsubscribe","parentobjectfilter","showallrecords","compprops","tablename","defaultsortparam","enablelocaldbdata","parentid","activeNoteId","action","console","log","localdata","dataParamsresult","rsdataParamsresult","dataParamsBeginswith","recordData","recordDataFinal","rsData","rsDataFinal","Object","keys","length","objectName","objectData","keyConditions","field","value","orgname","expression","filterConditions","isSuccess","alert","dataprops","Items","objectname","beginswith","userid","pageSize","limit","exclusiveStartKey","subscribetoIds","i","rsDatavar","push","fieldname","j","recordDataVar","indexOf","childfieldname","data","filter","id","setState","showUI","notes","noteHeadingClk","noteid","addNote","state","refreshNote","serverprops","childnoteHandler","recordid","createNote","componentDidMount","comphtmlid","listdisplaytype","iscreateactive","isviewactive","iseditactive","isdeleteactive","render","mainpanelHtml","notepageHtml","notesHtml","label"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Notepad from \"./notepad\";\nimport {\n  getRecorddata,\n  createRecord,\n  bulkcreateRecord,\n  deleteRecord,\n} from \"../db/index\";\nimport {\n  sortArray,\n  fieldTypeHtmltoDBmapping,\n  getLocalData,\n  serverButtonHandler,\n  filterArraybyObject,\n} from \"../js/index\";\n\nclass F extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      notes: [],\n      activeNoteId: \"\",\n      showUI: false,\n      createNote: false,\n      action: \"\",\n    };\n  }\n\n  async componentDidMount() {\n    let {\n      tablename,\n      comphtmlid,\n      showallrecordsubscribe,\n      parentobjectfilter,\n      showallrecords,\n      enablelocaldbdata,\n      listdisplaytype,\n      defaultdatafilter,\n      defaultsortparam,\n      parentid,\n      iscreateactive,\n      isviewactive,\n      iseditactive,\n      isdeleteactive,\n    } = this.props.compprops;\n    let props = {\n      tablename: tablename,\n      defaultsortparam: defaultsortparam,\n      enablelocaldbdata: enablelocaldbdata,\n      parentid: parentid,\n      //  defaultdatafilter: defaultdatafilter,\n      activeNoteId: \"\",\n      action: \"\",\n    };\n    await this.getServerData(props);\n  }\n\n  getServerData = async (props) => {\n    let {\n      defaultdatafilter,\n      showallrecordsubscribe,\n      parentobjectfilter,\n      showallrecords,\n    } = this.props.compprops;\n    let {\n      tablename,\n      defaultsortparam,\n      enablelocaldbdata,\n      parentid,\n      //  defaultdatafilter,\n      activeNoteId,\n      action,\n      //  showallrecordsubscribe,\n      //  parentobjectfilter,\n      //  showallrecords,\n    } = props;\n    console.log(props);\n    let localdata = getLocalData(this.props);\n\n    let dataParamsresult = {};\n    let rsdataParamsresult = {};\n    let dataParamsBeginswith = \"\";\n    let recordData = [];\n    let recordDataFinal = [];\n    let rsData = [];\n    let rsDataFinal = [];\n\n    if (\n      showallrecordsubscribe === \"true\" ||\n      Object.keys(parentobjectfilter).length > 0 ||\n      showallrecords === \"true\"\n    ) {\n      dataParamsBeginswith = defaultsortparam + \"-\";\n    } else {\n      dataParamsBeginswith = defaultsortparam + \"-\" + parentid;\n    }\n\n    dataParamsresult = await getRecorddata({\n      objectName: tablename,\n      objectData: {},\n      keyConditions: [\n        { field: \"orgname\", value: localdata.orgname, expression: \"=\" },\n        {\n          field: \"id\",\n          value: dataParamsBeginswith,\n          expression: \"beginswith\",\n        },\n      ],\n      filterConditions: [],\n    });\n    if (dataParamsresult.isSuccess === \"false\") {\n      alert(\"url not found\");\n    } else {\n      recordData = dataParamsresult.dataprops.Items;\n    }\n    console.log(recordData);\n\n    if (\n      showallrecordsubscribe === \"true\" ||\n      Object.keys(parentobjectfilter).length > 0\n    ) {\n      rsdataParamsresult = await getRecorddata({\n        objectName: parentobjectfilter.objectname,\n        objectData: {},\n        keyConditions: [\n          {\n            field: \"orgname\",\n            value: localdata.orgname,\n            expression: \"=\",\n          },\n          {\n            field: \"id\",\n            value: parentobjectfilter.beginswith + localdata.userid,\n            expression: \"beginswith\",\n          },\n        ],\n        filterConditions: [],\n        pageSize: \"\",\n        limit: \"\",\n        exclusiveStartKey: \"\",\n      });\n\n      if (rsdataParamsresult.isSuccess === \"false\") {\n        alert(\"url not found\");\n      } else {\n        rsData = rsdataParamsresult.dataprops.Items;\n        console.log(rsData);\n        let subscribetoIds = [];\n        for (let i = 0; i < rsData.length; i++) {\n          let rsDatavar = rsData[i];\n          subscribetoIds.push(rsDatavar[parentobjectfilter.fieldname]);\n        }\n        console.log(subscribetoIds);\n        for (let j = 0; j < recordData.length; j++) {\n          let recordDataVar = recordData[j];\n          if (\n            subscribetoIds.indexOf(\n              recordDataVar[parentobjectfilter.childfieldname]\n            ) !== -1 ||\n            recordDataVar[parentobjectfilter.childfieldname] ===\n              localdata.userid\n          ) {\n            recordDataFinal.push(recordData[j]);\n          }\n        }\n      }\n    } else {\n      recordDataFinal = recordData;\n    }\n    console.log(recordDataFinal);\n    recordDataFinal = filterArraybyObject({\n      data: recordDataFinal,\n      filter: defaultdatafilter,\n    });\n\n    if (recordDataFinal.length > 0) {\n      if (activeNoteId == \"\" && recordDataFinal.length > 0) {\n        activeNoteId = recordDataFinal[0].id;\n      }\n\n      if (action == \"\") {\n        action = recordDataFinal[0] ? \"view\" : \"create\";\n      }\n\n      this.setState({ showUI: false }, () => {\n        this.setState({\n          showUI: true,\n          notes: recordDataFinal,\n          activeNoteId: activeNoteId,\n          // createNote: filtereddata[0] ? false : true,\n          action: action,\n        });\n      });\n    } else {\n      this.setState({ showUI: false }, () => {\n        this.setState({\n          showUI: true,\n          notes: [],\n          activeNoteId: \"\",\n          action: \"create\",\n          //createNote: true,\n        });\n      });\n    }\n  };\n\n  noteHeadingClk = (noteid) => {\n    this.setState({ showUI: false }, () => {\n      this.setState({\n        showUI: true,\n        activeNoteId: noteid,\n        //  createNote: false,\n        action: \"view\",\n      });\n    });\n  };\n  addNote = () => {\n    let { notes } = this.state;\n    notes.push({});\n    this.setState({ showUI: false }, () => {\n      this.setState({ showUI: true, activeNoteId: \"\", action: \"create\" });\n    });\n  };\n\n  refreshNote = async (props) => {\n    let { noteid } = props;\n    let {\n      tablename,\n      defaultsortparam,\n      enablelocaldbdata,\n      parentid,\n      showallrecordsubscribe,\n      parentobjectfilter,\n      showallrecords,\n    } = this.props.compprops;\n    let serverprops = {\n      tablename: tablename,\n      defaultsortparam: defaultsortparam,\n      enablelocaldbdata: enablelocaldbdata,\n      parentid: parentid,\n      //  defaultdatafilter: defaultdatafilter,\n      activeNoteId: noteid,\n      action: \"view\",\n    };\n\n    await this.getServerData(serverprops);\n    // this.setState({ showUI: false }, () => {\n    //   this.setState({\n    //     showUI: true,\n    //     activeNoteId: noteid,\n    //     createNote: false,\n    //   });\n    // });\n  };\n  childnoteHandler = async (props) => {\n    let { recordid, action } = props;\n    let {\n      tablename,\n      defaultsortparam,\n      enablelocaldbdata,\n      parentid,\n    } = this.props.compprops;\n    let serverprops = {\n      tablename: tablename,\n      defaultsortparam: defaultsortparam,\n      enablelocaldbdata: enablelocaldbdata,\n      parentid: parentid,\n      //  defaultdatafilter: defaultdatafilter,\n      activeNoteId: recordid,\n      action: action,\n    };\n\n    await this.getServerData(serverprops);\n    // this.setState({ showUI: false }, () => {\n    //   this.setState({\n    //     showUI: true,\n    //     activeNoteId: noteid,\n    //     createNote: false,\n    //   });\n    // });\n  };\n\n  render() {\n    let {\n      iscreateactive,\n      isviewactive,\n      iseditactive,\n      isdeleteactive,\n    } = this.props.compprops;\n    let { notes, activeNoteId, showUI, action } = this.state;\n    console.log(this.props.compprops);\n    let mainpanelHtml = [];\n    let notepageHtml = [];\n    let notesHtml = [];\n    for (let i = 0; i < notes.length; i++) {\n      if (notes[i].id === activeNoteId) {\n        notesHtml.push(\n          <div\n            onClick={() => {\n              this.noteHeadingClk(notes[i].id);\n            }}\n            className=\"org-greybg\"\n          >\n            {notes[i].label}\n          </div>\n        );\n      } else {\n        notesHtml.push(\n          <div\n            onClick={() => {\n              this.noteHeadingClk(notes[i].id);\n            }}\n          >\n            {notes[i].label}\n          </div>\n        );\n      }\n    }\n    // if (notes.length > 0 && activeNoteId === \"\") {\n    //   activeNoteId = notes[0].id;\n    // }\n\n    notepageHtml.push(\n      <div className=\"org-fr\">\n        <div className=\"org-flexbasis-100p org-mflexbasis-10p org-lflexbasis-10p\">\n          {notesHtml}\n\n          {action === \"list\" || action === \"view\" ? (\n            iscreateactive === \"true\" ? (\n              <div onClick={this.addNote}>+</div>\n            ) : (\n              <></>\n            )\n          ) : (\n            <></>\n          )}\n        </div>\n        <div className=\"org-flexbasis-100p org-mflexbasis-90p org-lflexbasis-90p\">\n          {showUI === false ? (\n            \"\"\n          ) : (\n            <Notepad\n              {...this.props}\n              noteid={activeNoteId}\n              iseditactive={iseditactive}\n              isdeleteactive={isdeleteactive}\n              // createNote={createNote}\n              action={action}\n              //   refreshNote={this.refreshNote}\n              childnoteHandler={this.childnoteHandler}\n              //   defaultdatafilter={defaultdatafilter}\n            />\n          )}\n        </div>\n      </div>\n    );\n    mainpanelHtml.push(notepageHtml);\n\n    return <>{mainpanelHtml}</>;\n  }\n}\n\nexport default F;\n"]},"metadata":{},"sourceType":"module"}