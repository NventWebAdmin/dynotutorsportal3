{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{GetGoogleIcon}from\"./icons\";import Rteditor from\"./richtexteditor\";import{getRecorddata,createRecord,bulkcreateRecord}from\"../db/index\";import{sortArray,fieldTypeHtmltoDBmapping,getLocalData,serverButtonHandler}from\"../js/index\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var F=/*#__PURE__*/function(_Component){_inherits(F,_Component);var _super=_createSuper(F);function F(props){var _this;_classCallCheck(this,F);_this=_super.call(this,props);_this.sendMail=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var localdata,orgname,userid,_this$state,tomailselectedarray,subject,d,n,body,recorddata,result,msgObj;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:localdata=getLocalData(_this.props);console.log(localdata);orgname=localdata.orgname,userid=localdata.userid;_this$state=_this.state,tomailselectedarray=_this$state.tomailselectedarray,subject=_this$state.subject;d=new Date();n=d.getTime();body=document.getElementById(\"mailnewactiondiv\").innerHTML;console.log(tomailselectedarray);if(!(tomailselectedarray.length==0)){_context.next=12;break;}alert(\"To field cannot be empty\");_context.next=23;break;case 12:if(!(subject==\"\"||subject==undefined)){_context.next=16;break;}alert(\"Subject field cannot be empty\");_context.next=23;break;case 16:console.log(tomailselectedarray);recorddata={orgname:orgname,id:\"mail-\"+userid+n,from:userid,to:tomailselectedarray.toString(),subject:subject,body:body};console.log(recorddata);_context.next=21;return createRecord({objectName:\"orgmail\",objectData:recorddata});case 21:result=_context.sent;if(result.isSuccess===\"false\"){alert(result.message);}else{console.log(recorddata);msgObj={messagetype:\"mailsent-notify-recipitent\",message:\"\",orgname:orgname,id:\"mail-\"+userid+n,from:userid,userid:userid,to:tomailselectedarray.toString(),subject:subject,body:body};console.log(JSON.stringify(msgObj));_this.props.onmailsent({msgObj:msgObj});}case 23:case\"end\":return _context.stop();}}},_callee);}));_this.handleChange=function(e){if(e.target.name==\"subject\"){_this.setState({subject:e.target.value});}if(e.target.name==\"mailnnewactionto\"){if(e.target.value.includes(\"@\")){_this.setState({tomailsearchArray:[{label:\"pradeep\",name:\"pradeep\"},{label:\"kishan\",name:\"kishan\"},{label:\"mom\",name:\"mom\"}],tomail:e.target.value});document.getElementById(\"mailnnewactiontolist\").style.display=\"block\";}else{document.getElementById(\"mailnnewactiontolist\").style.display=\"none\";}}};_this.selectUser=function(x){var tomailselectedarray=_this.state.tomailselectedarray;if(!tomailselectedarray.includes(x)){tomailselectedarray.push(x);}var tomail=_this.state.tomail;tomail=tomail.replace(\"@\",\"\");_this.setState({tomailselectedarray:tomailselectedarray,tomail:\"\"});console.log(tomailselectedarray);document.getElementById(\"mailnnewactiontolist\").style.display=\"none\";};_this.cancelMail=function(){_this.props.backHandler({msgObj:{}});};_this.removeselecteduser=function(x){var tomailselectedarray=_this.state.tomailselectedarray;var temparray=[];for(var i=0;i<tomailselectedarray.length;i++){if(tomailselectedarray[i]!=x)temparray.push(tomailselectedarray[i]);}_this.setState({tomailselectedarray:temparray});};_this.state={tomailsearchArray:[],attherateindex:\"0\",tomail:\"\",tomailselectedarray:[],subject:\"\"};return _this;}_createClass(F,[{key:\"render\",value:function render(){var _this2=this;console.log(this.props);var _this$state2=this.state,tomailsearchArray=_this$state2.tomailsearchArray,tomail=_this$state2.tomail,tomailselectedarray=_this$state2.tomailselectedarray;var tomailsearchArrayHoverHtml=[];var tomailselectedarrayHtml=[];var _loop=function _loop(i){tomailsearchArrayHoverHtml.push(/*#__PURE__*/_jsx(\"div\",{style:{border:\"1px solid black\",padding:\"5px\"},onClick:function onClick(){_this2.selectUser(tomailsearchArray[i].name);},children:tomailsearchArray[i].label}));};for(var i=0;i<tomailsearchArray.length;i++){_loop(i);}var _loop2=function _loop2(_i){tomailselectedarrayHtml.push(/*#__PURE__*/_jsx(\"span\",{children:tomailselectedarray[_i]}));tomailselectedarrayHtml.push(/*#__PURE__*/_jsx(GetGoogleIcon,{name:\"close\",onClick:function onClick(){return _this2.removeselecteduser(tomailselectedarray[_i]);}}));};for(var _i=0;_i<tomailselectedarray.length;_i++){_loop2(_i);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"org-fr\",children:[/*#__PURE__*/_jsx(\"span\",{style:{width:\"10%\",display:\"inline-block\",textAlign:\"center\"},children:\"To\"}),/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",width:\"90%\"},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{style:{width:\"100%\"},onChange:this.handleChange,name:\"mailnnewactionto\",value:this.state.tomail})}),/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",zIndex:1,top:\"100%\",left:0,backgroundColor:\"red\",display:\"none\"},id:\"mailnnewactiontolist\",children:tomailsearchArrayHoverHtml})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"org-fr\",children:[/*#__PURE__*/_jsx(\"span\",{style:{width:\"10%\",display:\"inline-block\",textAlign:\"center\"}}),/*#__PURE__*/_jsx(\"div\",{className:\"org-fr org-fai-c \",children:tomailselectedarrayHtml})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"org-fr\",children:[/*#__PURE__*/_jsx(\"span\",{style:{width:\"10%\",display:\"inline-block\",textAlign:\"center\"},children:\"Subject\"}),/*#__PURE__*/_jsx(\"input\",{name:\"subject\",style:{width:\"90%\"},onChange:this.handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"org-fr\",children:[/*#__PURE__*/_jsx(\"span\",{style:{width:\"10%\",display:\"inline-block\",textAlign:\"center\"},name:\"subject\",children:\"Body\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"90%\"},children:/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:\"50vh\",backgroundColor:\"white\",color:\"black\"},contenteditable:\"true\",id:\"mailnewactiondiv\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"org-fr\",children:[/*#__PURE__*/_jsx(\"span\",{style:{width:\"10%\",display:\"inline-block\",textAlign:\"center\"}}),/*#__PURE__*/_jsx(\"input\",{style:{width:\"90%\"},type:\"file\",multiple:\"true\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"org-fr\",children:[/*#__PURE__*/_jsx(\"span\",{style:{width:\"10%\",display:\"inline-block\",textAlign:\"center\"}}),/*#__PURE__*/_jsx(\"button\",{contenteditable:\"true\",onClick:this.sendMail,children:\"Send\"}),/*#__PURE__*/_jsx(\"button\",{onClick:this.cancelMail,children:\"Back\"}),/*#__PURE__*/_jsx(Rteditor,{htmlid:\"mailnewactiondiv\"})]})]});}}]);return F;}(Component);export default F;","map":{"version":3,"sources":["/Users/pradeep/Downloads/twilioudemy1/nventwebgithub/dynotutorsportal3/src/components/mailnewaction.js"],"names":["React","Component","GetGoogleIcon","Rteditor","getRecorddata","createRecord","bulkcreateRecord","sortArray","fieldTypeHtmltoDBmapping","getLocalData","serverButtonHandler","F","props","sendMail","localdata","console","log","orgname","userid","state","tomailselectedarray","subject","d","Date","n","getTime","body","document","getElementById","innerHTML","length","alert","undefined","recorddata","id","from","to","toString","objectName","objectData","result","isSuccess","message","msgObj","messagetype","JSON","stringify","onmailsent","handleChange","e","target","name","setState","value","includes","tomailsearchArray","label","tomail","style","display","selectUser","x","push","replace","cancelMail","backHandler","removeselecteduser","temparray","i","attherateindex","tomailsearchArrayHoverHtml","tomailselectedarrayHtml","border","padding","width","textAlign","position","zIndex","top","left","backgroundColor","height","color"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { GetGoogleIcon } from \"./icons\";\nimport Rteditor from \"./richtexteditor\";\nimport { getRecorddata, createRecord, bulkcreateRecord } from \"../db/index\";\n\nimport {\n  sortArray,\n  fieldTypeHtmltoDBmapping,\n  getLocalData,\n  serverButtonHandler,\n} from \"../js/index\";\n\nclass F extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      tomailsearchArray: [],\n      attherateindex: \"0\",\n      tomail: \"\",\n      tomailselectedarray: [],\n      subject: \"\",\n    };\n  }\n  sendMail = async () => {\n    let localdata = getLocalData(this.props);\n    console.log(localdata);\n    let { orgname, userid } = localdata;\n    let { tomailselectedarray, subject } = this.state;\n    var d = new Date();\n    var n = d.getTime();\n\n    let body = document.getElementById(\"mailnewactiondiv\").innerHTML;\n    console.log(tomailselectedarray);\n    if (tomailselectedarray.length == 0) {\n      alert(\"To field cannot be empty\");\n    } else if (subject == \"\" || subject == undefined) {\n      alert(\"Subject field cannot be empty\");\n    } else {\n      console.log(tomailselectedarray);\n      let recorddata = {\n        orgname: orgname,\n        id: \"mail-\" + userid + n,\n        from: userid,\n        to: tomailselectedarray.toString(),\n        subject: subject,\n        body: body,\n      };\n      console.log(recorddata);\n      let result = await createRecord({\n        objectName: \"orgmail\",\n        objectData: recorddata,\n      });\n      if (result.isSuccess === \"false\") {\n        alert(result.message);\n      } else {\n        console.log(recorddata);\n        let msgObj = {\n          messagetype: \"mailsent-notify-recipitent\",\n          message: \"\",\n          orgname: orgname,\n          id: \"mail-\" + userid + n,\n          from: userid,\n          userid: userid,\n          to: tomailselectedarray.toString(),\n          subject: subject,\n          body: body,\n        };\n        console.log(JSON.stringify(msgObj));\n        this.props.onmailsent({ msgObj: msgObj });\n      }\n    }\n  };\n  handleChange = (e) => {\n    if (e.target.name == \"subject\") {\n      this.setState({ subject: e.target.value });\n    }\n    if (e.target.name == \"mailnnewactionto\") {\n      if (e.target.value.includes(\"@\")) {\n        this.setState({\n          tomailsearchArray: [\n            { label: \"pradeep\", name: \"pradeep\" },\n            { label: \"kishan\", name: \"kishan\" },\n            { label: \"mom\", name: \"mom\" },\n          ],\n          tomail: e.target.value,\n        });\n        document.getElementById(\"mailnnewactiontolist\").style.display = \"block\";\n      } else {\n        document.getElementById(\"mailnnewactiontolist\").style.display = \"none\";\n      }\n    }\n  };\n\n  selectUser = (x) => {\n    let tomailselectedarray = this.state.tomailselectedarray;\n    if (!tomailselectedarray.includes(x)) {\n      tomailselectedarray.push(x);\n    }\n\n    let tomail = this.state.tomail;\n    tomail = tomail.replace(\"@\", \"\");\n    this.setState({ tomailselectedarray: tomailselectedarray, tomail: \"\" });\n    console.log(tomailselectedarray);\n    document.getElementById(\"mailnnewactiontolist\").style.display = \"none\";\n  };\n\n  cancelMail = () => {\n    this.props.backHandler({ msgObj: {} });\n  };\n\n  removeselecteduser = (x) => {\n    let tomailselectedarray = this.state.tomailselectedarray;\n    let temparray = [];\n    for (let i = 0; i < tomailselectedarray.length; i++) {\n      if (tomailselectedarray[i] != x) temparray.push(tomailselectedarray[i]);\n    }\n    this.setState({ tomailselectedarray: temparray });\n  };\n\n  render() {\n    console.log(this.props);\n\n    let { tomailsearchArray, tomail, tomailselectedarray } = this.state;\n    let tomailsearchArrayHoverHtml = [];\n    let tomailselectedarrayHtml = [];\n    for (let i = 0; i < tomailsearchArray.length; i++) {\n      tomailsearchArrayHoverHtml.push(\n        <div\n          style={{ border: \"1px solid black\", padding: \"5px\" }}\n          onClick={() => {\n            this.selectUser(tomailsearchArray[i].name);\n          }}\n        >\n          {tomailsearchArray[i].label}\n        </div>\n      );\n    }\n    for (let i = 0; i < tomailselectedarray.length; i++) {\n      tomailselectedarrayHtml.push(<span>{tomailselectedarray[i]}</span>);\n      tomailselectedarrayHtml.push(\n        <GetGoogleIcon\n          name=\"close\"\n          onClick={() => this.removeselecteduser(tomailselectedarray[i])}\n        />\n      );\n    }\n\n    return (\n      <>\n        <div className=\"org-fr\">\n          <span\n            style={{\n              width: \"10%\",\n              display: \"inline-block\",\n              textAlign: \"center\",\n            }}\n          >\n            To\n          </span>\n          <div style={{ position: \"relative\", width: \"90%\" }}>\n            <div>\n              <input\n                style={{ width: \"100%\" }}\n                onChange={this.handleChange}\n                name=\"mailnnewactionto\"\n                value={this.state.tomail}\n              />\n            </div>\n\n            <div\n              style={{\n                position: \"absolute\",\n                zIndex: 1,\n                top: \"100%\",\n                left: 0,\n                backgroundColor: \"red\",\n                display: \"none\",\n              }}\n              id=\"mailnnewactiontolist\"\n            >\n              {tomailsearchArrayHoverHtml}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"org-fr\">\n          <span\n            style={{\n              width: \"10%\",\n              display: \"inline-block\",\n              textAlign: \"center\",\n            }}\n          ></span>\n          <div\n            className=\"org-fr org-fai-c\n        \"\n          >\n            {tomailselectedarrayHtml}\n          </div>\n        </div>\n\n        <div className=\"org-fr\">\n          <span\n            style={{\n              width: \"10%\",\n              display: \"inline-block\",\n              textAlign: \"center\",\n            }}\n          >\n            Subject\n          </span>\n          <input\n            name=\"subject\"\n            style={{ width: \"90%\" }}\n            onChange={this.handleChange}\n          />\n        </div>\n        <div className=\"org-fr\">\n          <span\n            style={{\n              width: \"10%\",\n              display: \"inline-block\",\n              textAlign: \"center\",\n            }}\n            name=\"subject\"\n          >\n            Body\n          </span>\n          <div style={{ width: \"90%\" }}>\n            <div\n              style={{\n                width: \"100%\",\n                height: \"50vh\",\n                backgroundColor: \"white\",\n                color: \"black\",\n              }}\n              contenteditable=\"true\"\n              id=\"mailnewactiondiv\"\n            ></div>\n          </div>\n        </div>\n        <div className=\"org-fr\">\n          <span\n            style={{\n              width: \"10%\",\n              display: \"inline-block\",\n              textAlign: \"center\",\n            }}\n          ></span>\n          <input style={{ width: \"90%\" }} type=\"file\" multiple=\"true\" />\n        </div>\n        <div className=\"org-fr\">\n          <span\n            style={{\n              width: \"10%\",\n              display: \"inline-block\",\n              textAlign: \"center\",\n            }}\n          ></span>\n          <button contenteditable=\"true\" onClick={this.sendMail}>\n            Send\n          </button>\n          <button onClick={this.cancelMail}>Back</button>\n\n          <Rteditor htmlid=\"mailnewactiondiv\" />\n        </div>\n      </>\n    );\n  }\n}\n\nexport default F;\n"]},"metadata":{},"sourceType":"module"}